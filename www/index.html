<!DOCTYPE html>
<head>
  <meta name="color-scheme" content="dark">
  <script type="text/javascript" src="./jmuxer.min.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      overflow: hidden;
    }

    #container, video {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="container">
    <div class="vsc-controller"></div>
    <video autoplay muted id="player"></video>
  </div>
  <script>
    function parse(data) {
      var input = new Uint8Array(data),
      video = input;

      return {
        video: video,
      };
    }

    window.onload = function () {
      var socketURL = window.location.origin.replace('http', 'ws') + '/video/stream';
      var jmuxer = new JMuxer({
        node: 'player',
        mode: 'video',
        debug: false
      });

      var ws = new WebSocket(socketURL);
      ws.binaryType = 'arraybuffer';
      ws.addEventListener('message', function (event) {
        var data = parse(event.data);
        jmuxer.feed(data);
      });
    }

    const video = document.querySelector("video");
    video.addEventListener("loadedmetadata", function (event) {
      var width = this.videoWidth,
          height = this.videoHeight;
      console.log(
        "The dimensions of the media and tracks are now known.", width, height
      );
    });
  </script>
</body>
